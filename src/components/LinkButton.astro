---
import { baseStyles, variantStyles, sizeStyles } from './button-styles';
import type { ButtonVariant, ButtonSize } from './button-styles';

interface Props {
  /** URL to navigate to */
  href: string;

  /** Visual style */
  variant?: ButtonVariant;

  /** Size preset */
  size?: ButtonSize;

  /** Stretch to container width */
  fullWidth?: boolean;

  /** Accessible label when visible text isn't descriptive */
  ariaLabel?: string;

  /** Target browsing context */
  target?: '_self' | '_blank' | '_parent' | '_top';

  /** Relationship hints for external links */
  rel?: string;
}

const {
  href,
  variant = 'primary',
  size = 'large',
  fullWidth = false,
  ariaLabel,
  target = '_self',
  rel,
} = Astro.props;

const widthStyle = fullWidth ? 'w-full' : '';

// If opening a new tab, ensure we include noopener/noreferrer for security.
// Let caller override via `rel` prop if they need to.
const normalizedTarget = target?.toLowerCase();
const computedRel =
  normalizedTarget === '_blank'
    ? (rel ? rel : 'noopener noreferrer')
    : rel;

const combinedStyles = [
  baseStyles,
  variantStyles[variant],
  sizeStyles[size],
  widthStyle,
]
  .filter(Boolean)
  .join(' ');
---

<a
  href={href}
  class={combinedStyles}
  target={target}
  rel={computedRel}
  aria-label={ariaLabel}
>
  <slot />
</a>
